{% extends "base.html" %}
{% block content %}
<style>
  .lb-wrap { max-width: 1100px; margin: 1rem auto; padding: 1rem; }
  .lb-header { display:flex; align-items:center; justify-content:space-between; margin-bottom: 1rem; }
  .btn { display:inline-block; padding:6px 10px; border:1px solid #d1d5db; border-radius:6px; text-decoration:none; color:#111; margin-right:6px; }
  .btn:hover { background:#f3f4f6; }
  .lb-muted { color:#6b7280; font-size:0.9rem; }

  .table { width: 100%; border-collapse: collapse; font-size: 0.95rem; }
  .table thead th { background:#f8fafc; font-weight:600; text-align:left; padding:12px; border-bottom:1px solid #e5e7eb; }
  .table tbody td { padding:12px; border-bottom:1px solid #f1f5f9; vertical-align: middle; }
  .table tbody tr:hover { background:#f8fafc; }

  .center { text-align:center; }
  .right { text-align:right; white-space:nowrap; }

  .chip { display:inline-block; padding:2px 8px; border-radius:999px; font-weight:600; font-size:0.9rem; line-height:1.6; }
  .chip.win { background:#dcfce7; color:#166534; }     /* green */
  .chip.loss { background:#fee2e2; color:#991b1b; }    /* red */
  .chip.push { background:#fef9c3; color:#92400e; }    /* yellow */
  .chip.pending { background:#f3f4f6; color:#4b5563; } /* gray */
  .muted { color:#9ca3af; }

  .hdr-top th { padding:6px 12px; font-size:0.9rem; background:#f8fafc; }
  .th-center { text-align:center; }
</style>

<div class="lb-wrap">
  <div class="lb-header">
  <div>
    {% if show_left %}
      {% if mock_week is not none %}
        <a class="btn" href="{{ url_for('leaderboard.leaderboard', week=display_week-1, mock_week=mock_week) }}" aria-label="Previous week">←</a>
      {% else %}
        <a class="btn" href="{{ url_for('leaderboard.leaderboard', week=display_week-1) }}" aria-label="Previous week">←</a>
      {% endif %}
    {% endif %}

    <strong style="font-size:1.1rem;">Week {{ display_week }}</strong>

    {% if show_right %}
      {% if mock_week is not none %}
        <a class="btn" href="{{ url_for('leaderboard.leaderboard', week=display_week+1, mock_week=mock_week) }}" aria-label="Next week">→</a>
      {% else %}
        <a class="btn" href="{{ url_for('leaderboard.leaderboard', week=display_week+1) }}" aria-label="Next week">→</a>
      {% endif %}
    {% endif %}
  </div>
  <div class="lb-muted">Current week: {{ current_week }}</div>
</div>

  <div style="overflow-x:auto; border:1px solid #e5e7eb; border-radius:10px;">
    <table class="table">
      <thead>
        <!-- Compact top row: only the W-L-P section headers -->
        <tr class="hdr-top">
          <th colspan="6"></th>
          <th class="th-center" colspan="3">This Week</th>
          <th class="th-center" colspan="3">Overall</th>
          <th></th>
        </tr>
        <tr>
          <th></th>
          <th>Pick 1</th><th>Pick 2</th><th>Pick 3</th><th>Pick 4</th><th>Pick 5</th>
          <th class="center">W</th><th class="center">L</th><th class="center">P</th>
          <th class="center">W</th><th class="center">L</th><th class="center">P</th>
          <th class="right">Pts</th>
        </tr>
      </thead>
      <tbody>
        {% for r in rows %}
        <tr>
          <td><strong>{{ r.display_name }}</strong></td>

          {# 5 colored pick cells #}
          {% for p in r.weekly_picks %}
            <td>
              {% if p.label %}
                {% if p.status in ['win','loss','push','pending'] %}
                  <span class="chip {{ p.status }}">{{ p.label|team_short }}</span>
                {% elif p.status == 'pre' %}
                  <span class="chip pending">{{ p.label|team_short }}</span>
                {% elif p.status == 'hidden' %}
                  <span class="muted">—</span>
                {% else %}
                  <span class="muted">—</span>
                {% endif %}
              {% else %}
                <span class="muted">—</span>
              {% endif %}
            </td>
          {% endfor %}

          {% set w, l, psh = r.week_WLP %}
          <td class="center" style="font-weight:600;">{{ w }}</td>
          <td class="center" style="font-weight:600;">{{ l }}</td>
          <td class="center" style="font-weight:600;">{{ psh }}</td>

          {% set sw, sl, sp = r.season_WLP %}
          <td class="center" style="font-weight:600;">{{ sw }}</td>
          <td class="center" style="font-weight:600;">{{ sl }}</td>
          <td class="center" style="font-weight:600;">{{ sp }}</td>

          <td class="right" style="font-weight:700;">{{ "%.1f"|format(r.points) }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
